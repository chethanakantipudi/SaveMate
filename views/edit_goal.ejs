<%- include('partials/header') %>

<style>
.input-with-icon { position: relative; }
.input-with-icon .form-input { padding-left: 2.5rem; }
.input-with-icon i {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
}
.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}
.form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    margin-top: 2rem;
    border-top: 1px solid var(--border-color);
    padding-top: 1.5rem;
}
@media (max-width: 500px) {
    .form-row { grid-template-columns: 1fr; }
}
</style>

<div class="auth-container animate-fade-in">
    <div class="card" style="max-width: 550px;">
        <h1 class="card-title" style="text-align: center;">
            <i class="fas fa-pencil-alt"></i> Edit Goal
        </h1>
        <form action="/goal/<%= goal.id %>/edit" method="POST">
            <div class="form-group">
                <label for="goal_name" class="form-label">Goal Name</label>
                <div class="input-with-icon">
                    <i class="fas fa-flag-checkered"></i>
                    <input type="text" id="goal_name" name="goal_name" class="form-input" required value="<%= goal.goal_name %>">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="goal_amount" class="form-label">Target Amount</label>
                    <div class="input-with-icon">
                        <i class="fas fa-coins"></i>
                        <input type="number" id="goal_amount" name="goal_amount" class="form-input" required step="0.01" min="1" value="<%= goal.end_total %>">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="goal_date" class="form-label">Target Date</label>
                    <div class="input-with-icon">
                        <i class="fas fa-calendar-alt"></i>
                        <%# FIXED: Use the pre-formatted date passed from the server %>
                        <input type="date" id="goal_date" name="goal_date" class="form-input" required value="<%= formattedDate %>">
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <a href="/goal/<%= goal.id %>" class="btn btn-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const dateInput = document.getElementById('goal_date');
        if(dateInput) {
            // Set minimum date to today
            dateInput.min = new Date().toISOString().split('T')[0];
        }
    });
</script>

<%- include('partials/footer') %>